Changes for issue 841